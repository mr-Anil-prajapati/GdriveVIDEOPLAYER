<!DOCTYPE html>
<html>
<head>

<!-- VideoJS CSS -->
<link href="https://vjs.zencdn.net/7.21.1/video-js.css" rel="stylesheet"/>

<!-- VR plugin CSS -->
<link href="https://unpkg.com/videojs-vr@1.10.0/dist/videojs-vr.css" rel="stylesheet"/>

<style>

/* ‚≠ê Custom VR goggles icon */
.vjs-icon-vr:before {
  content: "ü•Ω";
  font-size:16px;
}

</style>

</head>

<body>

<input type="file" id="videoUpload">

<br><br>

<video id="player"
       class="video-js vjs-default-skin"
       controls
       width="800"
       playsinline
       webkit-playsinline>
</video>

<!-- VideoJS -->
<script src="https://vjs.zencdn.net/7.21.1/video.min.js"></script>

<!-- AFRAME (required for VR) -->
<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>

<!-- videojs VR plugin -->
<script src="https://unpkg.com/videojs-vr@1.10.0/dist/videojs-vr.min.js"></script>

<script>

var player = videojs('player');

// ‚≠ê Create custom VR button
var Button = videojs.getComponent('Button');

var VRButton = videojs.extend(Button, {

  constructor: function(player, options) {
    Button.apply(this, arguments);
    this.controlText("VR Mode");
    this.addClass('vjs-icon-vr'); // VR goggles icon
  },

  handleClick: function() {

    if(player.vr()) {
        player.vr().togglePlay(); // toggle VR view
    }

  }

});

videojs.registerComponent('VRButton', VRButton);

// Add button to control bar
player.ready(function(){
   player.controlBar.addChild('VRButton', {});
});


// Upload video
document.getElementById('videoUpload').addEventListener('change', function(e){

  const file = e.target.files[0];
  if(!file) return;

  const url = URL.createObjectURL(file);

  player.src({
    src:url,
    type:"video/mp4"
  });

  player.one('loadedmetadata', function(){

      player.vr({
          projection:'360',
          motionControls:true
      });

  });

});

</script>

</body>
</html>
