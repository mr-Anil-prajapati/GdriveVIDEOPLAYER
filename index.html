<!DOCTYPE html>
<html>
<head>

<link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
<link href="https://unpkg.com/videojs-vr/dist/videojs-vr.css" rel="stylesheet">

</head>

<body>

<input type="file" id="videoUpload">

<br><br>

<!-- Added playsinline + preload -->
<video id="player"
       class="video-js vjs-default-skin"
       controls
       width="800"
       playsinline
       webkit-playsinline
       preload="auto">
</video>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
<script src="https://unpkg.com/videojs-vr/dist/videojs-vr.min.js"></script>

<script>

var player = videojs('player');

// Upload video
document.getElementById('videoUpload').addEventListener('change', function(e){

  const file = e.target.files[0];
  if(!file) return;

  const url = URL.createObjectURL(file);

  player.src({
    src:url,
    type:file.type
  });

  // Initialize VR AFTER source load
  player.vr({
    projection:'360',
    motionControls:true,
    debug:false,
    forceCardboard:false
  });

  // Add VR switch button in control bar
  if (!player.controlBar.getChild('VRSwitchButton')) {
    player.controlBar.addChild('VRSwitchButton');
  }

  // Mobile gyro permission (important for phone)
  if (typeof DeviceMotionEvent !== 'undefined' &&
      typeof DeviceMotionEvent.requestPermission === 'function') {
      DeviceMotionEvent.requestPermission().catch(()=>{});
  }

  // autoplay attempt (needed sometimes for gyro activation)
  player.play().catch(()=>{});

});

</script>

</body>
</html>
