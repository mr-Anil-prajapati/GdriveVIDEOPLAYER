<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet">
<link href="https://unpkg.com/videojs-vr/dist/videojs-vr.css" rel="stylesheet">

<style>

body { margin:0; background:#111; color:white; font-family:Arial;}

.container { display:flex; height:100vh; }

.player { flex:3; padding:20px; }

.sidebar { flex:1; background:#222; overflow:auto; padding:10px; }

.video-js { width:100% !important; height:80vh !important; }

button { padding:8px 16px; margin-right:10px; background:red; color:white; border:none; }

.video-item { cursor:pointer; padding:5px; }

</style>

</head>

<body>

<div class="container">

<div class="player">

<video id="mainPlayer" class="video-js vjs-default-skin" controls playsinline></video>

<br><br>

<button id="vrToggle">ğŸ¥½ VR OFF</button>
<button id="nextBtn">Next â–¶</button>
<input type="file" id="folderPicker" webkitdirectory multiple style="display:none;">
<button id="loadBtn">ğŸ“ Load Folder</button>

</div>

<div id="sidebar" class="sidebar"></div>

</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
<script src="https://unpkg.com/videojs-vr/dist/videojs-vr.min.js"></script>

<script>

const player = videojs('mainPlayer');

let vrEnabled=false;
let vrPlugin=null;

function applyVR(){

  if(vrPlugin){
    vrPlugin.reset();
    vrPlugin=null;
  }

  if(vrEnabled){

    vrPlugin = player.vr({
      projection:'360',
      motionControls:true
    });

  }

}

document.getElementById("vrToggle").onclick=function(){

  vrEnabled=!vrEnabled;

  this.textContent = vrEnabled ? "ğŸ¥½ VR ON" : "ğŸ¥½ VR OFF";

  applyVR();

};

const sidebar=document.getElementById("sidebar");
const folderPicker=document.getElementById("folderPicker");

let files=[];
let currentIndex=0;

document.getElementById("loadBtn").onclick=()=>folderPicker.click();

folderPicker.addEventListener("change", e=>{

  files=Array.from(e.target.files).filter(f=>f.type.startsWith("video"));

  sidebar.innerHTML="";

  files.forEach((file,i)=>{

    const div=document.createElement("div");
    div.className="video-item";
    div.textContent=file.name;
    div.onclick=()=>playVideo(i);

    sidebar.appendChild(div);

  });

  playVideo(0);

});

function playVideo(i){

  currentIndex=i;

  player.src({
    src:URL.createObjectURL(files[i]),
    type:files[i].type
  });

  player.ready(()=>{

    applyVR();   // IMPORTANT: reapply VR after source load
    player.play().catch(()=>{});

  });

}

document.getElementById("nextBtn").onclick=()=>{

  currentIndex=(currentIndex+1)%files.length;
  playVideo(currentIndex);

};

</script>

</body>
</html>
